{
  "id": "STORY-10",
  "title": "Multi-provider failover",
  "description": "Add failover chains so when an upstream provider returns 5xx or times out, the proxy automatically retries with the next provider in the chain. Only retry on 5xx (not 4xx). Tool-enhanced requests are not covered. Add failover_from column to store via schema migration.",
  "priority": "high",
  "sprint": 1,
  "status": "ready",
  "branch": "feat/STORY-10-multi-provider-failover",
  "merge_commit": null,
  "acceptance_criteria": [
    "New internal/failover package with chain lookup and IsRetryable(statusCode)",
    "Config supports failover.max_retries and failover.chains mapping",
    "Extract doUpstreamRequest() helper from proxy, wrap with retry loop",
    "Only retries on 5xx/timeout, not 4xx",
    "failover_from column added to requests table via schema migration",
    "Records original model in failover_from when failover occurs",
    "All tests pass, go vet clean"
  ],
  "tasks": [],
  "design": {},
  "implementation": {},
  "review": {},
  "testing": {},
  "audit_log": [
    {
      "timestamp": "2026-02-16T00:00:00Z",
      "agent": "team-lead",
      "action": "story_created",
      "detail": "Created STORY-10: Multi-provider failover (P0)"
    }
  ]
}
